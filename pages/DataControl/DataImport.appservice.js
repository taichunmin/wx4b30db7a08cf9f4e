$gwx_XC_49=function(_,_v,_n,_p,_s,_wp,_wl,$gwn,$gwl,$gwh,wh,$gstack,$gwrt,gra,grb,TestTest,wfor,_ca,_da,_r,_rz,_o,_oz,_1,_1z,_2,_2z,_m,_mz,nv_getDate,nv_getRegExp,nv_console,nv_parseInt,nv_parseFloat,nv_isNaN,nv_isFinite,nv_decodeURI,nv_decodeURIComponent,nv_encodeURI,nv_encodeURIComponent,$gdc,nv_JSON,_af,_gv,_ai,_grp,_gd,_gapi,$ixc,_ic,_w,_ev,_tsd){return function(path,global){
if(typeof global==='undefined'){if (typeof __GWX_GLOBAL__==='undefined')global={};else global=__GWX_GLOBAL__;}if(typeof __WXML_GLOBAL__ === 'undefined') {__WXML_GLOBAL__={};
}__WXML_GLOBAL__.modules = __WXML_GLOBAL__.modules || {};
var e_={}
if(typeof(global.entrys)==='undefined')global.entrys={};e_=global.entrys;
var d_={}
if(typeof(global.defines)==='undefined')global.defines={};d_=global.defines;
var f_={}
if(typeof(global.modules)==='undefined')global.modules={};f_=global.modules || {};
var p_={}
__WXML_GLOBAL__.ops_cached = __WXML_GLOBAL__.ops_cached || {}
__WXML_GLOBAL__.ops_set = __WXML_GLOBAL__.ops_set || {};
__WXML_GLOBAL__.ops_init = __WXML_GLOBAL__.ops_init || {};
var z=__WXML_GLOBAL__.ops_set.$gwx_XC_49 || [];
function gz$gwx_XC_49_1(){
if( __WXML_GLOBAL__.ops_cached.$gwx_XC_49_1)return __WXML_GLOBAL__.ops_cached.$gwx_XC_49_1
__WXML_GLOBAL__.ops_cached.$gwx_XC_49_1=[];
(function(z){var a=11;function Z(ops){z.push(ops)}
Z([3,'t-toast'])
Z([a,[3,'height:'],[[7],[3,'data_height']],[3,'px;background-color:white;']])
Z([[2,'=='],[[6],[[7],[3,'tabs']],[3,'folder']],[1,'folder']])
Z([3,'dir'])
Z([[6],[[7],[3,'Directory']],[3,'list']])
Z([3,'index'])
Z([[6],[[7],[3,'dir']],[3,'isFile']])
Z([3,'selectPath'])
Z([3,'directory'])
Z(z[6])
Z([[6],[[7],[3,'dir']],[3,'name']])
Z([[6],[[7],[3,'dir']],[3,'path']])
Z([3,'hover-directory'])
Z([1,200])
Z([3,'directory-icon'])
Z([[6],[[7],[3,'dir']],[3,'color']])
Z([[6],[[7],[3,'dir']],[3,'icon']])
Z(z[7])
Z(z[8])
Z(z[6])
Z(z[10])
Z(z[11])
Z(z[12])
Z(z[13])
Z(z[14])
Z(z[15])
Z(z[16])
Z([[2,'=='],[[6],[[7],[3,'tabs']],[3,'folder']],[1,'cardHub']])
Z([[7],[3,'is_login']])
Z([3,'onDownRefresh'])
Z([3,'onScroll'])
Z([3,'onScrollToLower'])
Z([[7],[3,'loadingProps']])
Z([[4],[[5],[[5],[[5],[[5],[1,'下拉刷新']],[1,'松手刷新']],[1,'正在刷新']],[1,'刷新完成']]])
Z([a,z[1][1],z[1][2],[3,'px;']])
Z([[6],[[7],[3,'dataRefresh']],[3,'value']])
Z([3,'onSearchDataChange'])
Z(z[36])
Z([3,'onSubmitSearchCardHub'])
Z([3,'cardhubs-search'])
Z([3,'搜索卡包名称/卡信息/地址'])
Z([[6],[[7],[3,'Search']],[3,'value']])
Z([3,'search-btn'])
Z([3,'action'])
Z([[7],[3,'is_loading']])
Z([3,'40rpx'])
Z([3,'circular'])
Z([[2,'!'],[[7],[3,'is_loading']]])
Z([[6],[[7],[3,'cardHubs']],[3,'list']])
Z(z[5])
Z([3,'onSelect'])
Z([[6],[[7],[3,'item']],[3,'Address']])
Z([[6],[[7],[3,'item']],[3,'ATQA']])
Z([[6],[[7],[3,'item']],[3,'freq']])
Z([[6],[[7],[3,'item']],[3,'MD5']])
Z([[6],[[7],[3,'item']],[3,'Name']])
Z([[6],[[7],[3,'item']],[3,'sak']])
Z([[6],[[7],[3,'item']],[3,'Type']])
Z([[6],[[7],[3,'item']],[3,'cardtype']])
Z([[6],[[7],[3,'item']],[3,'uid']])
Z(z[55])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'cardtype']],[1,2]])
Z([3,'#006400'])
Z(z[57])
Z([3,'square'])
Z([3,'note'])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'cardtype']],[1,3]])
Z([3,'#1E90FF'])
Z([3,'NTAG/ULEV1'])
Z(z[64])
Z(z[65])
Z([3,'loading-info'])
Z([[7],[3,'loading_info']])
Z([[7],[3,'backTopVisible']])
Z([a,[3,'--td-spacer-2:'],[[7],[3,'backtop_buttom']],z[34][3]])
Z([3,'顶部'])
Z([3,'未登录，请先登录'])
Z([[7],[3,'navigatorProps']])
Z([3,'medium'])
Z([3,'primary'])
Z([[2,'=='],[[6],[[7],[3,'tabs']],[3,'folder']],[1,'message']])
Z([3,'onOpenMessage'])
Z([3,'large'])
Z([3,'external-class'])
Z(z[79])
Z([3,'outline'])
Z([3,'dropdown-menu'])
Z([3,'onMessageFileTypeChange'])
Z([[6],[[7],[3,'MessageFile']],[3,'options']])
Z([[6],[[7],[3,'MessageFile']],[3,'type']])
Z([[2,'=='],[[6],[[7],[3,'tabs']],[3,'folder']],[1,'clipboard']])
Z([3,'onGetClipboardData'])
Z(z[82])
Z(z[83])
Z(z[79])
Z(z[85])
Z([1,true])
Z([a,z[1][1],[[7],[3,'data_textarea_height']],z[34][3]])
Z([[6],[[7],[3,'clipboard']],[3,'value']])
Z([3,'onTabsChange'])
Z([3,'custom-tabs'])
Z([3,'folder'])
Z([[6],[[7],[3,'tabs']],[3,'folder']])
Z([3,'文件夹'])
Z(z[101])
Z([3,'卡包'])
Z([3,'cardHub'])
Z([3,'聊天记录'])
Z([3,'message'])
Z([3,'剪贴板'])
Z([3,'clipboard'])
Z([3,'closeDirectoryFileDialog'])
Z([3,'deleteDirectoryFileDialog'])
Z([3,'取消'])
Z([3,'删除'])
Z([3,'是否删除该文件？'])
Z(z[114])
Z([[6],[[7],[3,'Directory']],[3,'delete']])
})(__WXML_GLOBAL__.ops_cached.$gwx_XC_49_1);return __WXML_GLOBAL__.ops_cached.$gwx_XC_49_1
}
__WXML_GLOBAL__.ops_set.$gwx_XC_49=z;
__WXML_GLOBAL__.ops_init.$gwx_XC_49=true;
var x=['./pages/DataControl/DataImport.wxml'];d_[x[0]]={}
var m0=function(e,s,r,gg){
var z=gz$gwx_XC_49_1()
var l9S=_n('t-toast')
_rz(z,l9S,'id',0,e,s,gg)
_(r,l9S)
var a0S=_n('view')
_rz(z,a0S,'style',1,e,s,gg)
var tAT=_v()
_(a0S,tAT)
if(_oz(z,2,e,s,gg)){tAT.wxVkey=1
var xET=_v()
_(tAT,xET)
var oFT=function(cHT,fGT,hIT,gg){
var cKT=_v()
_(hIT,cKT)
if(_oz(z,6,cHT,fGT,gg)){cKT.wxVkey=1
var oLT=_n('t-swipe-cell')
var lMT=_mz(z,'view',['bind:tap',7,'class',1,'data-file',2,'data-name',3,'data-path',4,'hoverClass',5,'hoverStayTime',6],[],cHT,fGT,gg)
var aNT=_mz(z,'t-icon',['class',14,'color',1,'name',2],[],cHT,fGT,gg)
_(lMT,aNT)
_(oLT,lMT)
_(cKT,oLT)
}
else{cKT.wxVkey=2
var tOT=_mz(z,'view',['bind:tap',17,'class',1,'data-file',2,'data-name',3,'data-path',4,'hoverClass',5,'hoverStayTime',6],[],cHT,fGT,gg)
var ePT=_mz(z,'t-icon',['class',24,'color',1,'name',2],[],cHT,fGT,gg)
_(tOT,ePT)
_(cKT,tOT)
}
cKT.wxXCkey=1
cKT.wxXCkey=3
cKT.wxXCkey=3
return hIT
}
xET.wxXCkey=4
_2z(z,4,oFT,e,s,gg,xET,'dir','index','index')
}
var eBT=_v()
_(a0S,eBT)
if(_oz(z,27,e,s,gg)){eBT.wxVkey=1
var bQT=_v()
_(eBT,bQT)
if(_oz(z,28,e,s,gg)){bQT.wxVkey=1
var oRT=_mz(z,'t-pull-down-refresh',['bind:change',29,'bind:scroll',1,'bind:scrolltolower',2,'loadingProps',3,'loadingTexts',4,'style',5,'value',6],[],e,s,gg)
var oTT=_n('t-sticky')
var fUT=_mz(z,'t-search',['bind:change',36,'bind:clear',1,'bind:submit',2,'class',3,'placeholder',4,'value',5],[],e,s,gg)
var cVT=_mz(z,'view',['class',42,'slot',1],[],e,s,gg)
var hWT=_v()
_(cVT,hWT)
if(_oz(z,44,e,s,gg)){hWT.wxVkey=1
var cYT=_mz(z,'t-loading',['size',45,'theme',1],[],e,s,gg)
_(hWT,cYT)
}
var oXT=_v()
_(cVT,oXT)
if(_oz(z,47,e,s,gg)){oXT.wxVkey=1
}
hWT.wxXCkey=1
hWT.wxXCkey=3
oXT.wxXCkey=1
_(fUT,cVT)
_(oTT,fUT)
_(oRT,oTT)
var oZT=_v()
_(oRT,oZT)
var l1T=function(t3T,a2T,e4T,gg){
var o6T=_mz(z,'t-cell',['hover',-1,'bind:click',50,'data-address',1,'data-atqa',2,'data-freq',3,'data-md5',4,'data-name',5,'data-sak',6,'data-type',7,'data-typeid',8,'data-uid',9,'title',10],[],t3T,a2T,gg)
var x7T=_v()
_(o6T,x7T)
if(_oz(z,61,t3T,a2T,gg)){x7T.wxVkey=1
var f9T=_mz(z,'t-badge',['color',62,'count',1,'shape',2,'slot',3],[],t3T,a2T,gg)
_(x7T,f9T)
}
var o8T=_v()
_(o6T,o8T)
if(_oz(z,66,t3T,a2T,gg)){o8T.wxVkey=1
var c0T=_mz(z,'t-badge',['color',67,'count',1,'shape',2,'slot',3],[],t3T,a2T,gg)
_(o8T,c0T)
}
x7T.wxXCkey=1
x7T.wxXCkey=3
o8T.wxXCkey=1
o8T.wxXCkey=3
_(e4T,o6T)
return e4T
}
oZT.wxXCkey=4
_2z(z,48,l1T,e,s,gg,oZT,'item','index','index')
var hAU=_mz(z,'t-divider',['class',71,'content',1],[],e,s,gg)
_(oRT,hAU)
var xST=_v()
_(oRT,xST)
if(_oz(z,73,e,s,gg)){xST.wxVkey=1
var oBU=_mz(z,'t-back-top',['style',74,'text',1],[],e,s,gg)
_(xST,oBU)
}
xST.wxXCkey=1
xST.wxXCkey=3
_(bQT,oRT)
}
else{bQT.wxVkey=2
var cCU=_mz(z,'t-link',['hover',-1,'underline',-1,'content',76,'navigatorProps',1,'size',2,'theme',3],[],e,s,gg)
_(bQT,cCU)
}
bQT.wxXCkey=1
bQT.wxXCkey=3
bQT.wxXCkey=3
}
var bCT=_v()
_(a0S,bCT)
if(_oz(z,80,e,s,gg)){bCT.wxVkey=1
var oDU=_mz(z,'t-button',['block',-1,'bind:tap',81,'size',1,'tClass',2,'theme',3,'variant',4],[],e,s,gg)
_(bCT,oDU)
var lEU=_n('t-dropdown-menu')
_rz(z,lEU,'tClass',86,e,s,gg)
var aFU=_mz(z,'t-dropdown-item',['bindchange',87,'options',1,'value',2],[],e,s,gg)
_(lEU,aFU)
_(bCT,lEU)
}
var oDT=_v()
_(a0S,oDT)
if(_oz(z,90,e,s,gg)){oDT.wxVkey=1
var tGU=_mz(z,'t-button',['block',-1,'bind:tap',91,'size',1,'tClass',2,'theme',3,'variant',4],[],e,s,gg)
_(oDT,tGU)
var eHU=_mz(z,'t-textarea',['disableDefaultPadding',96,'style',1,'value',2],[],e,s,gg)
_(oDT,eHU)
}
tAT.wxXCkey=1
tAT.wxXCkey=3
eBT.wxXCkey=1
eBT.wxXCkey=3
bCT.wxXCkey=1
bCT.wxXCkey=3
oDT.wxXCkey=1
oDT.wxXCkey=3
_(r,a0S)
var bIU=_mz(z,'t-tabs',['bind:change',99,'class',1,'defaultValue',2,'value',3],[],e,s,gg)
var oJU=_mz(z,'t-tab-panel',['label',103,'value',1],[],e,s,gg)
_(bIU,oJU)
var xKU=_mz(z,'t-tab-panel',['label',105,'value',1],[],e,s,gg)
_(bIU,xKU)
var oLU=_mz(z,'t-tab-panel',['label',107,'value',1],[],e,s,gg)
_(bIU,oLU)
var fMU=_mz(z,'t-tab-panel',['label',109,'value',1],[],e,s,gg)
_(bIU,fMU)
_(r,bIU)
var cNU=_mz(z,'t-dialog',['bind:cancel',111,'bind:confirm',1,'cancelBtn',2,'confirmBtn',3,'content',4,'title',5,'visible',6],[],e,s,gg)
_(r,cNU)
return r
}
e_[x[0]]={f:m0,j:[],i:[],ti:[],ic:[]}
if(path&&e_[path]){
return function(env,dd,global){$gwxc=0;var root={"tag":"wx-page"};root.children=[]
;g="$gwx_XC_49";var main=e_[path].f
if (typeof global==="undefined")global={};global.f=$gdc(f_[path],"",1);
try{
main(env,{},root,global);
_tsd(root)
}catch(err){
console.log(err)
}
;g="";
return root;
}
}
}
}(__g.a,__g.b,__g.c,__g.d,__g.e,__g.f,__g.g,__g.h,__g.i,__g.j,__g.k,__g.l,__g.m,__g.n,__g.o,__g.p,__g.q,__g.r,__g.s,__g.t,__g.u,__g.v,__g.w,__g.x,__g.y,__g.z,__g.A,__g.B,__g.C,__g.D,__g.E,__g.F,__g.G,__g.H,__g.I,__g.J,__g.K,__g.L,__g.M,__g.N,__g.O,__g.P,__g.Q,__g.R,__g.S,__g.T,__g.U,__g.V,__g.W,__g.X,__g.Y,__g.Z,__g.aa);if(__vd_version_info__.delayedGwx||false)$gwx_XC_49();	if (__vd_version_info__.delayedGwx) __wxAppCode__['pages/DataControl/DataImport.wxml'] = [$gwx_XC_49, './pages/DataControl/DataImport.wxml'];else __wxAppCode__['pages/DataControl/DataImport.wxml'] = $gwx_XC_49( './pages/DataControl/DataImport.wxml' );
	;__wxRoute = "pages/DataControl/DataImport";__wxRouteBegin = true;__wxAppCurrentFile__="pages/DataControl/DataImport.js";define("pages/DataControl/DataImport.js",function(require,module,exports,window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){
"use strict";var a,t=(a=require("tdesign-miniprogram/toast/index"))&&a.__esModule?a:{default:a},e=require("../../utils/util"),i=require("../../utils/fileUtil"),o=require("../../utils/cardUtil");var n=getApp();Page({data:{is_login:!1,use_page:"",data_height:0,data_scroll_height:0,data_textarea_height:0,Directory:{root_path:"",list:[],delete:!1,delete_path:""},tabs:{value:"folder"},backtop_buttom:100,loadingProps:{size:"50rpx"},navigatorProps:{url:"/pages/Login/wxLogin"},Search:{value:""},dataRefresh:{value:!1},loading_info:"下拉刷新",backTopVisible:!1,is_loading:!1,cardHubs:{list:[],Index:0,totalCount:0,sync:!1,init:!0},pageSize:0,searchValue:"",MessageFile:{name:"",type:"all",options:[{value:"all",label:"所有文件(*.*)"},{value:"IC",label:"IC卡数据(*.bin;*.txt;*.dump)"},{value:"ID",label:"ID卡数据(*.id;*.txt)"},{value:"ULEV1",label:"Ultralight/Ntag卡数据(*.ulev1;*.u;*.txt)"}]},clipboard:{value:""}},onLoad:function(a){a.page&&(this.data.use_page=a.page);var t="".concat(wx.env.USER_DATA_PATH,"/CopyKEY");this.DoShowFileList(t),this.setData({"tabs.folder":"folder"})},onReady:function(){var a=n.getSystemInfo(),t=a.the1rpx,e=a.pageHeight;this.setData({data_height:e-96*t,data_scroll_height:e-36-96*t,data_textarea_height:e-160*t-96*t});var i=256*t;this.data.pageSize=Math.ceil(this.data.data_scroll_height/2*3/i),this.initDownloadTagDatas()},onShow:function(){this.initDownloadTagDatas()},initDownloadTagDatas:function(){this.data.pageSize<=0||this.getUserInfo()&&(this.setData({cardHubs:this.data.cardHubs,loading_info:this.data.cardHubs.list.length<=0&&!0!==n.globalData.data.cardHubs.init?"无数据，请先添加数据":this.data.loading_info}),this.data.cardHubs.sync||this.onDownloadTagDatas(!1))},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(){},DoShowFileList:function(a){var t=a,e=new i.fileUtil,o="".concat(wx.env.USER_DATA_PATH),n=t;"/"===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),t.indexOf(o)>=0&&(n=t.replace(o,"."));var s=0;e.access(t)?t===o?(n="/",s=0):(o=t,s=1):(n="/",s=0);var r=e.readdir(o);if(r){var l=new Array;if(s>0){var d=o,c=o.lastIndexOf("/");c>0&&(d=d.substring(0,c+1));var u={icon:"rollback",color:"#0000FF",isFile:!1,name:"上一级",path:d};l.push(u)}"/"!=o.charAt(o.length-1)&&(o+="/"),r.forEach((function(a){var t=e.stat(o+a,!1);if(t){var i={icon:"",color:"",isFile:!1,name:a,path:o+a},n=!0;t.isFile()?(i.color="#05A1FF",i.icon="file",i.isFile=!0):t.isDirectory()?(i.color="#F5D472",i.icon="folder",i.isFile=!1):n=!1,n&&l.push(i)}})),this.setData({"Directory.root_path":n,"Directory.list":l})}},selectPath:function(a){var t=a.currentTarget.dataset.path;a.currentTarget.dataset.file?this.DoImport(a.currentTarget.dataset.name,t):this.DoShowFileList(t)},onDeleteData:function(a){var t=a.currentTarget.dataset.path;this.data.Directory.delete_path=t,this.setData({"Directory.delete":!0})},DoImport:function(a,n){var s=new o.cardUtil,r=new i.fileUtil;try{if(!r.access(n))throw"文件不存在";a.length>0&&(a=a.substring(0,a.lastIndexOf(".")));var l=n.substring(n.lastIndexOf(".")+1);if("ID"!==(l=l.toUpperCase())&&"ULEV1"!==l&&"U"!==l&&"DUMP"!==l&&"BIN"!==l&&"TXT"!==l)throw"不支持导入该文件";var d=r.readFile(n);if(!d)throw"打开文件失败";var c=Array.prototype.slice.call(new Uint8Array(d));if(c.length<=0)throw"导入数据空";var u="",h=0;if("ID"===l){if(57!=c.length)throw"导入数据格式错误";h=s.card_type.id;for(var g=0;g<57;g++)u+=("00"+c[g].toString(16)).slice(-2).toUpperCase()}else if("ULEV1"===l||"U"===l){if(!s.isRightULEV1TagData(c))throw"导入的数据长度/格式错误";h=s.card_type.ULEV1;for(var f=0;f<36;f++)u+=("00"+c[f].toString(16)).slice(-2).toUpperCase()}else if("DUMP"===l||"BIN"===l){if(!s.isRightMFTagData(c))throw"导入的数据长度/格式错误";h=s.card_type.MF;for(var D=0;D<16;D++)u+=("00"+c[D].toString(16)).slice(-2).toUpperCase()}else if("TXT"===l){var p=(0,e.byte2string)(c),v=s.GetTxtData(p);if(!(v.card_type>0&&v.card_info.length>0&&v.card_buffer.length>0))throw"导入的数据长度/格式错误";h=v.card_type,u=v.card_info,c=v.card_buffer}this.navigateBackData(a,h,u,c)}catch(a){console.log(a),"string"==typeof a&&a.length>0?(0,t.default)({context:this,duration:5e3,selector:"#t-toast",message:a}):(0,t.default)({context:this,duration:5e3,selector:"#t-toast",message:"导入异常"})}},navigateBackData:function(a,t,e,i){var o=getCurrentPages();if(o.length>=2){var n=o[o.length-2];"pages/DataControl/index"===n.route?"DataControl"===this.data.use_page?n.setCardData(a,t,e,i):"DataDecode"===this.data.use_page&&n.doDecodeByFile(t,i):"pages/DataControl/DataComp"===n.route&&n.setCompData(t,i,"Import"===this.data.use_page)}wx.navigateBack()},onTabsChange:function(a){this.setData({"tabs.folder":a.detail.value})},onOpenMessage:function(){this.selectMessageFile()},selectMessageFile:function(){var a=this,t=void 0;"IC"===a.data.MessageFile.type?t=["bin","txt","dump"]:"ID"===a.data.MessageFile.type?t=["id","txt"]:"ULEV1"===a.data.MessageFile.type&&(t=["ulev1","u","txt"]),wx.chooseMessageFile({count:1,type:"file",extension:t,success:function(t){var e=t.tempFiles;e.length>0&&a.DoImport(e[0].name,e[0].path)}})},onMessageFileTypeChange:function(a){this.setData({"MessageFile.type":a.detail.value})},onGetClipboardData:function(a){var t=new o.cardUtil,e=this;wx.getClipboardData({success:function(a){e.setData({"clipboard.value":a.data});var i=t.GetTxtData(a.data);i.card_type>0&&i.card_info.length>0&&i.card_buffer.length>0?e.navigateBackData("",i.card_type,i.card_info,i.card_buffer):wx.showToast({title:"不支持导入该数据",duration:5e3,icon:"none"})}})},getUserInfo:function(){try{var a=wx.getStorageSync("userInfo");return this.setData({is_login:!!a}),a}catch(a){}return null},onScroll:function(a){var t=a.detail.scrollTop;this.setData({backTopVisible:t>100})},onScrollToLower:function(){this.onDownloadTagDatas(!1)},onDownRefresh:function(a){a.detail.value&&(this.data.searchValue="",this.setData({"Search.value":""}),this.onDownloadTagDatas(!0))},onSearchDataChange:function(a){this.setData({"Search.value":a.detail.value})},onSearchCardHub:function(a){this.DoSearchCardHub(this.data.Search.value)},onSubmitSearchCardHub:function(a){this.DoSearchCardHub(a.detail.value)},DoSearchCardHub:function(a){this.data.searchValue=a,this.onDownloadTagDatas(!0)},onSelect:function(a){this.data.is_login?this.onDownloadTagDataItem(a.target.dataset.md5):wx.navigateTo({url:"/pages/Login/wxLogin"})},onDownloadTagDatas:function(a){var t=this;if(a&&(t.data.cardHubs={list:[],Index:0,totalCount:0,sync:!1,init:!0},this.setData({cardHubs:t.data.cardHubs,is_loading:!1})),t.data.is_loading)console.log("正在加载，请耐心等待");else{var i=t.getUserInfo();if(i){var n={wechat_id:i.wechat_id,user_account:i.user_account,searchValue:t.data.searchValue,Index:t.data.cardHubs.Index,pageSize:t.data.pageSize};(0,e.request)("GET","CopyKEY/GetCardHub",n,(function(a){if(null!=a){var i=a;if(i.success&&0===i.code&&i.data){if(t.data.cardHubs.init=!1,i.data.totalCount>0){var n=[],s=new o.cardUtil;i.data.list.forEach((function(a){var t=s.getCardInfo(a.cardtype,a.info,null),i={Name:a.name,Type:t.Type,UIDInfo:t.CardInfo,Address:a.address,MD5:a.MD5,info:a.info,cardtype:a.cardtype,uid:(0,e.hex2string)(t.Data.uid,t.Data.size),ATQA:(0,e.hex2string)(t.Data.ATQA,2,!0),sak:t.Data.sak,freq:t.Data.freq};n.push(i)})),n=t.data.cardHubs.list.concat(n);var r=i.data.skipIndex+i.data.takeCount,l=i.data.totalCount;t.data.cardHubs={list:n,Index:r,totalCount:l,sync:r===l},t.setData({cardHubs:t.data.cardHubs,loading_info:r<l?"上拉加载更多":"已加载全部数据",is_loading:!1})}else t.data.cardHubs={list:[],Index:0,totalCount:0,init:!1},t.setData({cardHubs:t.data.cardHubs,loading_info:"无数据，请先添加数据",is_loading:!1});return}}t.setData({loading_info:"加载失败，请重新下拉刷新",is_loading:!1})}),(function(a){t.setData({loading_info:"加载失败，请重新下拉刷新",is_loading:!1})}),(function(a){t.setData({"dataRefresh.value":!1,is_loading:!1})})),t.setData({loading_info:"努力加载中...",is_loading:!0})}}},onDownloadTagDataItem:function(a){var t=this;var i=wx.getStorageSync("userInfo");if(i){var s={wechat_id:i.wechat_id,user_account:i.user_account,md5:a};(0,e.request)("GET","CopyKEY/GetCardHubItem",s,(function(a){if(null!=a){var e=a;if(e.success&&0===e.code&&e.data){var i=new o.cardUtil,n=e.data,s=i.data2HexData(n.data);t.navigateBackData(n.name,n.cardtype,n.info,s)}}}),(function(a){}),(function(a){n.hideToast(t,"#t-toast")})),n.showLoadingToast(this,"#t-toast")}},closeDirectoryFileDialog:function(){this.setData({"Directory.delete":!1})},deleteDirectoryFileDialog:function(){var a=this;(new i.fileUtil).removeSavedFile(a.data.Directory.delete_path,(function(t){for(var e in a.data.Directory.list){if(a.data.Directory.list[e].path===a.data.Directory.delete_path){a.data.Directory.list.splice(e,1);break}}a.data.Directory.delete_path="",a.setData({"Directory.delete":!1,"Directory.list":a.data.Directory.list})}))}});
},{isPage:true,isComponent:true,currentFile:'pages/DataControl/DataImport.js'});require("pages/DataControl/DataImport.js");